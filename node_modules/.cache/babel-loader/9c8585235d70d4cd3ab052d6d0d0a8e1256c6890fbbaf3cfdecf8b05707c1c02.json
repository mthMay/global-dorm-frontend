{"ast":null,"code":"var _jsxFileName = \"/Users/maythuhtun/dev/Year3/GlobalDormFull/global-dorm-frontend/src/pages/Profile.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState, useContext } from \"react\";\nimport api from \"../api/apiConfig\";\nimport UserContext from \"../components/UserContext\";\nimport { Link } from \"react-router-dom\";\nimport '../style/Profile.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Profile = () => {\n  _s();\n  const {\n    user\n  } = useContext(UserContext);\n  const [applications, setApplications] = useState([]);\n  const [message, setMessage] = useState('');\n  useEffect(() => {\n    if (user) {\n      api.get(`/api/users/${user.username}`).then(response => {\n        return api.get(`/api/applications/applicant/${response.data.id}`);\n      }).then(async response => {\n        const apps = response.data;\n        const activeApplications = apps.filter(app => app.status !== \"CANCELLED\");\n        const applicationsWithRoomNames = await Promise.all(activeApplications.map(async app => {\n          const roomResponse = await api.get(`/api/rooms/${app.roomId}`);\n          return {\n            ...app,\n            roomName: roomResponse.data.name\n          };\n        }));\n        setApplications(applicationsWithRoomNames);\n      }).catch(err => {\n        setMessage(\"Failed to load applications.\");\n      });\n    }\n  }, [user]);\n  const handleUpdateStatus = async (applicationId, status) => {\n    try {\n      await api.patch(`/api/applications/${status}/${applicationId}`);\n      if (status === \"CANCELLED\") {\n        setApplications(applications.filter(app => app.id !== applicationId));\n      } else {\n        setApplications(applications.map(app => app.id === applicationId ? {\n          ...app,\n          status\n        } : app));\n      }\n    } catch (err) {\n      console.error(\"Error updating application status:\", err);\n      setMessage(\"Failed to update application status.\");\n    }\n  };\n  if (!user) {\n    return /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"Please log in to view your profile.\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 16\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"profile\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: [user.username, \"'s Applications\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 13\n    }, this), message && /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"message\",\n      children: message\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 25\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"applications\",\n      children: applications.length === 0 ? /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"No applications found.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 21\n      }, this) : applications.map(app => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"application\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Room Name:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 68,\n            columnNumber: 33\n          }, this), \" \", /*#__PURE__*/_jsxDEV(Link, {\n            to: `/api/roomDetails/${app.roomId}`,\n            className: \"room-link\",\n            children: app.roomName || app.roomId\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 69,\n            columnNumber: 33\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 67,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Status:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 73,\n            columnNumber: 32\n          }, this), \" \", app.status]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 73,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => handleUpdateStatus(app.id, \"accept\"),\n          disabled: !(app.status === \"PENDING\" || app.status === \"ACCEPTED\" || app.status === \"REJECTED\"),\n          children: \"Accept\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 74,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => handleUpdateStatus(app.id, \"reject\"),\n          disabled: !(app.status === \"PENDING\" || app.status === \"ACCEPTED\" || app.status === \"REJECTED\"),\n          children: \"Reject\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => handleUpdateStatus(app.id, \"cancel\"),\n          children: \"Cancel\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 29\n        }, this)]\n      }, app.id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 25\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 58,\n    columnNumber: 9\n  }, this);\n};\n_s(Profile, \"xVc8mVj8UTW917GMbW7wO9isWYE=\");\n_c = Profile;\nexport default Profile;\nvar _c;\n$RefreshReg$(_c, \"Profile\");","map":{"version":3,"names":["React","useEffect","useState","useContext","api","UserContext","Link","jsxDEV","_jsxDEV","Profile","_s","user","applications","setApplications","message","setMessage","get","username","then","response","data","id","apps","activeApplications","filter","app","status","applicationsWithRoomNames","Promise","all","map","roomResponse","roomId","roomName","name","catch","err","handleUpdateStatus","applicationId","patch","console","error","children","fileName","_jsxFileName","lineNumber","columnNumber","className","length","to","onClick","disabled","_c","$RefreshReg$"],"sources":["/Users/maythuhtun/dev/Year3/GlobalDormFull/global-dorm-frontend/src/pages/Profile.js"],"sourcesContent":["import React, { useEffect, useState, useContext } from \"react\";\nimport api from \"../api/apiConfig\";\nimport UserContext from \"../components/UserContext\";\nimport {Link} from \"react-router-dom\";\nimport '../style/Profile.css';\n\nconst Profile = () => {\n    const { user } = useContext(UserContext);\n    const [applications, setApplications] = useState([]);\n    const [message, setMessage] = useState('');\n\n    useEffect(() => {\n        if (user) {\n            api.get(`/api/users/${user.username}`)\n                .then(response => {\n                    return api.get(`/api/applications/applicant/${response.data.id}`);\n                })\n                .then(async response => {\n                    const apps = response.data;\n\n                    const activeApplications = apps.filter(app => app.status !== \"CANCELLED\");\n                    const applicationsWithRoomNames = await Promise.all(\n                        activeApplications.map(async app => {\n                            const roomResponse = await api.get(`/api/rooms/${app.roomId}`);\n                            return { ...app, roomName: roomResponse.data.name };\n                        })\n                    );\n\n                    setApplications(applicationsWithRoomNames);\n                })\n                .catch(err => {\n                    setMessage(\"Failed to load applications.\");\n                })\n        }\n    }, [user]);\n\n    const handleUpdateStatus = async (applicationId, status) => {\n        try {\n            await api.patch(`/api/applications/${status}/${applicationId}`);\n            if (status === \"CANCELLED\") {\n                setApplications(applications.filter(app => app.id !== applicationId));\n            } else {\n                setApplications(applications.map(app =>\n                    app.id === applicationId ? { ...app, status } : app\n                ));\n            }\n        } catch (err) {\n            console.error(\"Error updating application status:\", err);\n            setMessage(\"Failed to update application status.\");\n        }\n    };\n\n    if (!user) {\n        return <p>Please log in to view your profile.</p>;\n    }\n\n    return (\n        <div className=\"profile\">\n            <h2>{user.username}'s Applications</h2>\n            {message && <p className=\"message\">{message}</p>}\n            <div className=\"applications\">\n                {applications.length === 0 ? (\n                    <p>No applications found.</p>\n                ) : (\n                    applications.map(app => (\n                        <div key={app.id} className=\"application\">\n                            <p>\n                                <strong>Room Name:</strong>{\" \"}\n                                <Link to={`/api/roomDetails/${app.roomId}`} className=\"room-link\">\n                                    {app.roomName || app.roomId}\n                                </Link>\n                            </p>\n                            <p><strong>Status:</strong> {app.status}</p>\n                            <button\n                                onClick={() => handleUpdateStatus(app.id, \"accept\")}\n                                disabled={!(app.status === \"PENDING\" || app.status === \"ACCEPTED\" || app.status === \"REJECTED\")}\n                            >\n                                Accept\n                            </button>\n                            <button\n                                onClick={() => handleUpdateStatus(app.id, \"reject\")}\n                                disabled={!(app.status === \"PENDING\" || app.status === \"ACCEPTED\" || app.status === \"REJECTED\")}\n                            >\n                                Reject\n                            </button>\n                            <button\n                                onClick={() => handleUpdateStatus(app.id, \"cancel\")}\n                            >\n                                Cancel\n                            </button>\n                        </div>\n                    ))\n                )}\n            </div>\n        </div>\n    );\n};\n\nexport default Profile;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}